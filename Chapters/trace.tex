%!TEX root = ../main.tex
\chapter{Trace and Residue}\label{ch:trace-and-residue}
We extend the definition of trace to a certain class of infinite dimensional operators to define an abstract residue. We follow the original structure in Tate's elegant article \cite{Tate} while translating his statements in the language of Tate's Linear Algebra.
\section{Finitepotent maps and their trace}
Let $k$ be a fixed ground field and $V$ a vector space over $k$. In this section we will expand the notion of trace of a linear endomorphism to include certain operators even when $V$ is infinite dimensional.
\subsection*{Finitepotent maps}
\begin{definition}\label{def:finitepotent}
	We will say a linear map $f\colon V \to V$ is \textbf{finitepotent} if
	\[
		\dim f^{n}(V) < \infty
	\]
	for sufficiently large $n$.
\end{definition}
We characterize finitepotent maps as follows.
\begin{lemma}\label{lemm:characterization-of-finitepotent-maps}
	A linear map $f\colon V \to V$ is finitepotent if and only if there exists a subspace $W \subseteq V$ such that
	\begin{enumerate}[label = (\roman*)]
		\item $\dim f(W) < \infty$,
		\item $f(W) \subseteq W$,
		\item the induced map $\bar{f}\colon V/W \to V/W$ is nilpotent.
	\end{enumerate}
\end{lemma}
\begin{proof}
	If $f$ is finitepotent choose $W = f^{n}(V)$ for sufficiently large $n$. The first condition follows from definition. Also, $f(W) = f^{n+1}(V) \subseteq f^{n}(V) = W$. In addition, $\bar{f}^{n} = 0$. On the other hand, if such $W$ exists, note that condition (ii) assures that $\bar{f}$ is well defined. Moreover, as $\bar{f}$ is nilpotent, $f^{n}V \subseteq W$ for sufficiently large $n$ and by condition (i) above $\dim f^{n}(V) < \infty$.
\end{proof}
\subsection*{Trace}
If $f$ is a finitepotent map and $W$ is as above, $\tr_{V}(f)\in k$ may be defined as $\tr_{W}(f)$ where $\tr_{W}(f)$ is the ordinary trace of $f$ viewed as a endomorphism of $W$ (which is defined since $f$ has finite-rank viewed in $\End(W)$). First, we will check that this definition does not depend on the choice of $W$. Suppose $W_{1}, W_{2} \subseteq V$ suffice the properties on \cref{lemm:characterization-of-finitepotent-maps}, then $W = W_{1} + W_{2}$ suffices them too. Hence, as the induced maps on $W/W_{1}$ and $W/W_{2}$ are nilpotent, they have have zero ordinary trace and since
\begin{align*}
	\tr_{W}(f) &= \tr_{W_{1}}(f) + \tr_{W/W_{1}}(f) \\
	\tr_{W}(f) &= \tr_{W_{2}}(f) + \tr_{W/W_{2}}(f),
\end{align*}
we obtain $\tr_{W_{1}}(f) = \tr_{W_{2}}(f)$, our desired result. 

This definition extends some of the properties of the ordinary trace.
\begin{lemma}\label{lemm:properties-trace}
	\begin{enumerate}[label = (\alph*)]
		\item If $\dim V < \infty$, any endomorphism $f$ is finitepotent and $\tr_{V}(f)$ coincides with the ordinary trace.
		\item If $f$ is nilpotent, then it is finitepotent and $\tr_{V}(f) = 0$.
		\item If $f$ is finitepotent and $U$ is a subspace such that $f(U) \subseteq U$ then the induced maps on $U$ and $V/U$ are finitepotent and satisfy
		\[
		 	\tr_{V}(f) = \tr_{U}(f) + \tr_{V/U}(f)
		 \] 
	\end{enumerate}
\end{lemma}
\begin{proof}
	Both (a) and (b) are immediate. For (c) if $W$ suffices the properties in \cref{lemm:characterization-of-finitepotent-maps} for $f$ then $W\cap U$ and $(W + U)/U$ suffice them for the induced maps, that is, they're finitepotent. Since $W/(W\cap U) \cong W+U/U$, the diagram
	\[
		\begin{tikzcd}
			W/(W\cap U) \arrow[r, "\cong"] \arrow[d, "f"] & (W+U)/U \arrow[d, "f"] \\
			W/(W\cap U) \arrow[r, "\cong"] & (W+U)/U
		\end{tikzcd}
	\]
	commutes and trace is invariant under conjugation, we get $\tr_{W/(W\cap U)}(f) = \tr_{(W+U)/U}(f)$. Hence
	\[
	 	\tr_{V}(f) = \tr_{W}(f) = \tr_{W\cap U}(f) + \tr_{(W+U)/U}(f) = \tr_{U}(f) + \tr_{V/U}(f)
	\]
\end{proof}
\begin{definition}\label{def:finitepotent subspace}
	A subspace $F$ of $\End_{k}(V)$ is said to be a \textbf{finitepotent subspace} if there exists an $n$ such that for any family of $n$ elements $f_{1}, \ldots, f_{n}\in F$, the space $f_{1}f_{2}\cdots f_{n}V$ is finite dimensional. Note that every $f \in F$ is finitepotent.
\end{definition}
The following is the natural linearity property for $\tr$.
\begin{proposition}\label{prop:linearity-trace}
	If $F$ is a finitepotent subspace then $\tr_{V}\colon F\to k$ is $k$-linear
\end{proposition}
\begin{proof}
	It is enough to prove it in the case that $F$ is finite dimensional. Let $W = F^{n}V$ for $n$ as in the definition of finitepotent subspace, thus $\dim W < \infty$. Hence, for all $f\in F$, $W$ suffices the conditions in \cref{lemm:characterization-of-finitepotent-maps}. It follows that $\tr_{V}(f) = \tr_{W}(f)$ which is linear.
\end{proof}
\begin{remark}\label{rem:general-linearity-trace}
	In his paper, Tate asked if general linearity for finitepotent maps followed. His question was answered negatively in \cite{TATE-TRACE-COUNTER-EXAMPLE} where general linearity is reduced to the following: if the sum of two nilpotent endomorphisms is finitepotent, is the sum necessarily traceless?  
\end{remark}
\begin{proposition}\label{prop:trace-inavriant-under-commutator}
	If $f,g \in \End_{k}(V)$ and $fg$ is finitepotent then $gf$ is also finitepotent and 
	\[
		\tr_{V}(fg) = \tr_{V}(gf).
	\]
\end{proposition}
\begin{proof}
	Since $fg$ is finitepotent let $W =(fg)^{n}V$ for sufficiently large $n$ has finite dimension. On the other hand, $(gf)^{n+1}V= g(fg)^{n}f(V) \subseteq g(W)$, therefore, $gf$ is also finitepotent. Let $W' = (gf)^{n}V$, then $g(W') \subseteq W$ and $f(W) \subseteq W'$. Thus, 
	\[
		\dim W' \leq \dim g(W) \leq \dim W,
	\]
	and, 
	\[
		\dim W \leq \dim f(W) \leq \dim W',
	\]
	which implies that $W\cong W'$ and that $g$ and $f$ induce mutually inverse isomorphisms between $W$ and $W'$. Moreover, the diagram
	\[
		\begin{tikzcd}
			W \arrow[r, "fg"]\arrow[d, "g"] & W \arrow[d, "g"] \\
			W' \arrow[r, "gf"] & W'
		\end{tikzcd}
	\]
	commutes. We conclude $\tr_{W}(fg) = \tr_{W'}(gf)$ and it follows $\tr_{V}(fg) = \tr_{V}(gf)$.
\end{proof}
\subsection*{Trace and Tate Spaces}\label{Tate-and-trace}
Suppose that $V$ is a Tate space and consider $E = \End_{k}(V)$ the space of continuous endomorphisms of $V$. Thus, by \cref{prop:compact-and-discrete-2-sided-ideal} and \cref{prop:discrete-compact-operators-present-the-whole-space} we have 2-sided ideals $E_{0}, E_{+}$ and $E_{-}$ of $E$ such that $E_{+} + E_{-} = E$ and $E_{0} = E_{+} \cap E_{-}$. Moreover, \cref{rem:discrete-composition-compact} implies that $E_{0}$ is a finitepotent subspace.
\begin{lemma}\label{lemm:traceless-commutator}
	Suppose $f \in E_{+}$ and $g \in E_{-}$ or $f \in E_{-}$ and $g\in E_{+}$. Then the commutator $[f,g] = fg - gf$ belongs to $E_{0}$ and it is traceless.
\end{lemma}
\begin{proof}
	This immediate from the previous discussion and \cref{prop:trace-inavriant-under-commutator}.
\end{proof}

\section{Differential Calculus}
In this section we introduce the theory of derivations and differentials over an arbitrary commutative ring $A$. Let $M$ be a $A$-module and $k$ a commutative ring. We follow \cite{EGA4} Section 20 and \cite{Matsumura} Section 25. 
\begin{definition}\label{def:derivations-and-differentials}
	A \textbf{derivation} from $A$ to $M$ is a map $D\colon A \to M$ satisfying properties
	\begin{enumerate}[label = (\roman*)]
			\item $D(a + b) = D(a) + D(b)$ and,
			\item (\textit{Leibniz's Rule}) $D(ab) = aD(b) + bD(a)$ 
	\end{enumerate}
for all $a,b \in A$. The set of derivations from $A$ to $M$ becomes a $A$-module in a natural way. We will write it as $\Der(A,M)$. Moreover if $A$ is a $k$-algebra through a map $\varphi\colon k \to A$ we say that $D$ is a $\mathbf{k}$-\textbf{derivation} if $D$ is a derivation and $D \circ \varphi = 0$. In this case, the set of all $k$-derivations is denoted $\Der_{k}(A,M)$.

If $M = A$, we will denote $\Der_{k}(A,A)$ simply by $\Der_{k}(A)$. In particular, if $D$ and $D'$ are two $k$-derivations then its bracket $[D,D'] = DD' - D'D$ under composition as $A \to A$ maps is also a $k$-derivation. Therefore, $\Der_{k}(A)$ under this structure is a Lie Algebra.
\end{definition}
\begin{definition}\label{def:extension-of-algebras}
Let $B$ be a $k$-algebra and $C$ an ideal in $B$ with $C^{2} = 0$; set $A =B/C$. In this way, $C$ can be viewed as a $A$-module. In this situation we say that $B$ is an \textbf{extension} of the $k$-algebra $A$ by the $A$-module $C$. Usually, we simply write the exact sequence
\[\label{eqn:extension}
	0 \to C \to B \xrightarrow{\pi} A \to 0
\]
As usual, we will say that such sequence \textbf{splits} if there exists a retraction; that is, a $k$-algebra homomorphism $\rho\colon A \to B$ such that $\pi \circ \rho = 1_{A}$. In this case we can identify $B = C\oplus A$. Conversely, starting from any $k$-algebra $A$ and any $A$-module $C$, one can always define a structure on $A \oplus C$ such that $A\oplus C$ is an extension of $A$ by $C$. Namely, 
\[
			(a,c)(a',c') = (aa',ac' + a'c)
\]
for $a,a'\in A$ and $c,c' \in C$. Common notations for this algebra are $D_{A}(C)$ or $A * C$.		
\end{definition}
\begin{definition}\label{def:lifting}
Given a commutative diagram of $k$-algebras
\[
	\begin{tikzcd}
		 	B \arrow[r, "f"] & A \\
		 	& C\arrow[lu, "h"] \arrow[u, "g"]
	\end{tikzcd} 
\]
thinking of $f$ as a fixed map; we say that $h$ is a \textbf{lifting} of $g$ to $B$. 
\end{definition}
\begin{lemma}\label{lemm:two-liftings}
	Suppose we're given a commutative diagram as in the previous definition with an additional lifting $h'\colon C \to B$. Then, if $K = \ker f$ satisfies $K^{2} = 0$ it follows that $h - h'\colon C \to K$ is a $k$-derivation. Conversely, if $D \in \Der_{k}(C, K)$ then $h + D$ is another lifting of $g$ to $B$.
\end{lemma}
\begin{proof}
	First, observe that $(h - h')(C)$ lies in $K$ because both $h$ and $h'$ are liftings of $g$ to $B$. Since $K^{2} = 0$, then $K$ can be considered as $f(B)$-module and by means of $g$ as a $C$-module. Then, $h-h'\colon C \to K$ is a map of $C$-modules. Now, let $c,c' \in C$ then
	\begin{align*}
	(h -h')(cc') &= h(c)h(c') - h'(c)h'(c') \\
	&= h(c)h(c') - h'(c)h'(c') - h(c)h'(c') + h'(c')h(c) \\
	\end{align*}
	since $c \cdot k = h(c)k = h'(c)k$ for all $k \in K$ it follows that
	\begin{align*}
		(h -h')(cc') &= c\cdot h(c') - c'\cdot h'(c') - c\cdot h'(c') + c'\cdot h(c) \\
		&= c\cdot (h - h')(c') + c'\cdot (h - h')(c)
	\end{align*}
	which implies that $h - h'$ is a $k$-derivation. Observe that $h + D$ is a lifting because $D(C)$ lies in $K$.
\end{proof}
\begin{theorem}\label{prop:differentials-representable-functor}
	If $A$ is a $k$-algebra, consider the covariant functor from the category $\mathsf{Mod}_{A}$ to itself given by $M \mapsto \Der_{k}(A,M)$. This functor is representable. 
\end{theorem}
\begin{proof}
	Let $\mu\colon A \otimes_{k} A \to A$ be the $k$-algebra homomorphism given by $f \otimes g \to fg$. Set
	\[
		I = \ker \mu, \quad \Omega_{A/k} = I/I^{2}, \quad \text{and,} \quad B = (A \otimes_{k} A)/I^{2}.
	\]
	Thus, $\mu$ induces $\mu'\colon B \to A$ such that
	\[
		0 \to \Omega_{A/k} \to B \to A \to 0
	\]
	is an extension of $A$ by $\Omega_{A/k}$. We claim that this extension splits. Moreover it has two splittings, by considering retractions
	\[
		j_{1}\colon A \to B \quad\text{and,}\quad j_{2}\colon A \to B,
	\]
	defined by $a \mapsto a\otimes 1$ mod $I^{2}$ and $a \mapsto 1 \otimes a$ mod $I^{2}$. By \cref{lemm:two-liftings} $d := j_{2} - j_{1}$ is a $k$-derivation of $A$ to $\Omega_{A/k}$. Now, we prove that 
	\begin{align}\label{eqn:representable}
		\Der_{k}(A,M) &\cong \Hom_{A}(\Omega_{A/k}, M).
	\end{align}	
	Let $D \in \Der_{k}(A,M)$ and define $\varphi\colon A \otimes_{k} A \to A * M$ by $\varphi(x \otimes y) = (xy, xD(y))$ then $\varphi$ is a $k$-algebra homomorphism since it is compatible with the operation in $A * M$ defined in \cref{def:extension-of-algebras}. In addition, if $\sum x_{i} \otimes y_{i}$ lies in $I$ then
	\[
		\mu\left(\sum x_{i} \otimes y_{i}\right) = \sum x_{i}y_{i} = 0 \implies \varphi\left(\sum x_{i} \otimes y_{i}\right) = (0, \sum x_{i}D(y_{i}))
	\]
	whence $\varphi(I)$ lies in $M$. Moreover, by Leibniz's Rule $\varphi$ factors through $I^{2}$ yielding a map $f\colon \Omega_{A/k}\to M$. For $a \in A$ it follows that 
	\begin{align*}
		f(da) &= f(1 \otimes a - a \otimes 1 \mod I^{2}) = \varphi(1 \otimes a) - \varphi(a \otimes 1) \\
		&= D(a) - aD(1) = D(a). 
	\end{align*} 	
	Therefore, $D = f\circ d$. Now, we prove that such $f$ is unique. First, observe that $\Omega_{A/k}$ has the $A$-module structure induced by multiplication by $a \otimes 1$ (or $1 \otimes a$ since $1 \otimes a - a \otimes 1 \in I$). Therefore, if $\xi = \sum x_{i} \otimes y_{i} \mod I^{2} \in \Omega_{A/k}$ then $a\xi = \sum ax_{i}\otimes y_{i} \mod I^{2}$, and $f(a\xi) = \sum ax_{i}D(y_{i}) = af(\xi)$, so that $f$ is $A$-linear. We have
	\[
		a \otimes a' = (a \otimes 1)(1 \otimes a' - a' \otimes 1) +  aa' \otimes 1
	\]
	so that if $\omega = \sum x_{i}\otimes y_{i} \in I$ then $\omega \mod I^{2} = \sum x_{i} dy_{i}$ since $\sum x_{i}y_{i} = 0$. We conclude that $\{da\mid a\in A\}$ is a set of generators for the $A$-module $\Omega_{A/k}$. This implies uniqueness of $f$. Therefore, (\ref{eqn:representable}) holds.
\end{proof}
\begin{definition}\label{def:module-of-differentials}
	The module $\Omega_{A/k}$ introduced in the proof of the previous theorem is called \textbf{module of differentials} of $A$ over $k$ or \textbf{module of KÃ¤hler differentials}, and for $a \in A$ the element $da\in \Omega_{A/k}$ is called the \textbf{differential} of $a$.
\end{definition}
\begin{example}\label{ex:differentials-of-polynomials}
	If $A$ is generated as $k$-algebra by a subset $S \subseteq A$ then $\Omega_{A/k}$ is generated by $\{ds\mid s \in S\}$. Indeed, if $a \in A$ then there exist $a_{i}\in S$ and a polynomial $f(X) \in k[X_{1}, \ldots, X_{n}]$ such that $a = f(a_{1}, \ldots, a_{n})$. Thus,
	\[
		da = \sum_{i=1}^{n} f_{i}(a_{1}, \ldots, a_{n})da_{i} \quad \text{where}\quad f_{i} = \partial_{i}f
	\]
	In particular if $A = k[X_{1}, \ldots, X_{n}]$ then $\Omega_{A/k} = A dX_{1} + \ldots A dX_{n}$ since $X_{1}, \ldots, X_{n}$ are linearity independent; this follows immediate from the fact that $\partial_{i} X_{j} = \delta_{ij}$.
\end{example}
\begin{lemma}\label{lemm:c-map-differentials}
	Let $K$ be a $k$-commutative algebra. There exists a $k$-linear map
	\[
		c\colon K \otimes_{k} K \to \Omega_{K/k}
	\]
	so that $f \otimes g \mapsto fdg$ satisfying:
	\begin{enumerate}[label = (\roman*)]
		\item $c$ is surjective.
		\item $\ker c$ is generated over $k$ by the elements of the form
		\[
			f \otimes gh - fg \otimes h - fh \otimes g
		\]
	\end{enumerate}
\end{lemma}
\begin{proof}
	The $k$-bilinear map $(f,g) \mapsto fdg$ induces $c$. Since $\{df \mid f\in K\}$ is a generating set for $\Omega_{K/k}$ as a $K$-module it follows that $c$ is surjective. 
\end{proof}


\textcolor{red}{Further theory to be included if necessary.}
\section{Abstract Residue and its properties}
During this section let $k$ be a field, $K$ a commutative $k$-algebra with $1$, and $V$ a $K$-module so that when viewed as a $k$-vector space is a Tate space and for all $f \in K$ the map 
\begin{align*}
	f\colon &V \to V \\
	&x \mapsto fx 
\end{align*}
is continuous. In this way, $K$ operates on $V$ through $E$ (maintaining notation from \cref{Tate-and-trace}). We will not differentiate $f\in K$ with its induced map in $E$.
\begin{lemma}\label{lemm:trace-only-depends-on-K}
	Let $f,g \in K$. Then, there are $f_{+}, g_{+} \in E_{+}$ so that 
	\[
	f = f_{+} \mod E_{-} ,\quad g = g_{+} \mod E_{-}
	\]
	and, the equality
	\[
		\tr([f_{+},g_{+}]) = \tr([f, g_{+}]) = \tr([f_{+}, g])
	\]
	holds.
\end{lemma}
\begin{proof}
The existence of $f_{+}$ and $g_{+}$ is immediate from the fact that $E = E_{+} + E_{-}$.  Clearly $[f_{+},g_{+}]\in E_{+}$ and the fact that $K$ is commutative implies that $[f,g] = 0$. Therefore,
\[
	[f_{+},g_{+}] = [f,g] \mod E_{-}.
\]
Hence, $[f_{+},g_{+}]\in E_0$. Similarly, $[f,g_{+}]$ and $[f_{+}, g]$ belong to $E_{0}$. Whence, one can consider their trace. Furthermore, $f_{+} \in E_{+}$ and $g_{+} - g \in E_{-}$ thus $\tr([f_{+}, g_{+} - g]) = 0$ by \cref{lemm:traceless-commutator}; we conclude $\tr([f_{+}, g_{+}]) = \tr([f_{+}, g])$. The other equality follows similarly.
\end{proof}
The previous lemma implies that common values of traces $[f_{+},g_{+}]$, $[f_{+}, g]$ and $[f, g_{+}]$ depend only on $f$ and $g$ and not in the choice of $f_{+}$ and $g_{+}$. Therefore, one could define an assignment $(f,g) \mapsto \tr([f_{+}, g_{+}])$ which turns out to be $k$-bilinear by \cref{prop:linearity-trace}. Thus, there exists a map
\begin{align*}
	r\colon &K\otimes_{k} K \to k \\
	&f \otimes g \mapsto \tr([f_{+}, g_{+}])
\end{align*}
With these tools at our hands we are ready to prove the existence of residue.
\begin{theorem}\label{thm:existence-of-residue}
	There exists a unique $k$-linear map
	\[
		\res_{V}\colon \Omega_{K/k}\to k
	\]
	such that for each pair of elements $f,g \in K$ we have
	\[
		\res_{V}(fdg) = \tr([f_{+}, g_{+}]).
	\]
\end{theorem}
\begin{proof}
	Let $c\colon K \otimes_{k} K \to \Omega_{K/k}$ be as in \cref{lemm:c-map-differentials}. Then, since $c$ is surjective, $\res_{V}$ it it exists can only be the unique map so that the diagram
	\[
	\begin{tikzcd}
		K \otimes_{k} K \arrow[r, "r"] \arrow[d, two heads, "c"] & k \\
		\Omega_{K/k} \arrow[ur, dotted, swap, "\res_{V}"] &
	\end{tikzcd}
	\]
	commutes. Therefore, such map exists if and only if it vanishes on $\ker c$. To see this, let $f,g$ and $h$ in $K$ and choose $f_{+}, g_{+}$ and $h_{+}$ in $E_{+}$ projections in $E_{+}$. Then,
	\[
		fg = f_{+}g_{+} + (f_{+}g_{-} + f_{-}g_{+} + f_{-}g_{-}),
	\]
	and $f_{+}g_{-} + f_{-}g_{+} + f_{-}g_{-} \in E_{-}$. Whence, $(fg)_{+} = f_{+}g_{+}$. Analogously $(gh)_{+} = g_{+}h_{+}$ and $(fh)_{+} = f_{+}h_{+}$. This fact and the identify
	\[
		[f_{+},g_{+}h_{+}] - [f_{+}g_{+}, h_{+}] - [f_{+}h_{+}, g_{+}] = 0
	\]
	imply the desired conclusion.
\end{proof}
\subsection*{Properties of $\res$}
We prove some of the main properties of $\res$.
\begin{proposition}\label{prop:linearity-residue}
	For all $f,g \in K$ it follows that
	\begin{enumerate}[label = (\alph*)]
		\item $\res_{V}(fdg) + \res_{V}(gdf) = 0$, and
		\item $\res_V(df) = 0$.
	\end{enumerate}
\end{proposition}
\begin{proof}
	Since $[f_{+}, g_{+}] + [g_{+}, f_{+}] = 0$ we get (a). For (b) use (a) with $g = 1$. 
\end{proof}
\begin{proposition}\label{prop:linearity-residue-closed-submodule}
	Let $W$ be a closed $K$-submodule of $V$. Then, for $\omega \in \Omega_{K/k}$
	\[
		\res_{V}(\omega) = \res_{W}(\omega) + \res_{V/W}(\omega)
	\]
	holds.
\end{proposition}
\begin{proof}
	It is enough to prove it for $\omega = f dg$. By \cref{lemm:properties-trace} item (c) we only need to check that for all $f \in K$ the induced map $\overline{f}\colon V/W \to V/W$ and $f \circ \iota$, where $\iota$ denotes the inclusion $W \to V$, suffice 
	\begin{align*}
	\overline{f} &= \overline{f_{+}} \mod E_{-}(V/W), \\
	f \circ \iota &= f_{+} \circ \iota \mod E_{-}(W), \\ 
	\overline{f_{+}}&\in E_{+}(W), \quad\text{and} \\
	f_{+} \circ \iota &\in E_{+}(W),
	\end{align*}
	where $E_{\pm}(V/W)$ and $E_{\pm}(W)$ denote compact and discrete operators in $V/W$ and $W$ respectively. These statements are straightforward and we leave them as an exercise to the reader.
\end{proof}
As a direct consequence of the previous proposition we get the following:
\begin{proposition}\label{prop:direct-sum-residue}
	If $V$ is the direct sum of two closed submodules $W_{1}$ and $W_{2}$ then 
	\[
		\res_{V}(\omega) = \res_{W_{1}}(\omega) + \res_{W_{2}}(\omega)
	\]
	holds for all $\omega \in \Omega_{K/k}$.
\end{proposition}
If our Tate space is trivial so its residue.
\begin{proposition}\label{prop:residue-trivial-tate-space}
	If $V$ is either linearly compact or discrete then $\res_{V}(\Omega_{K/k}) = 0$.
\end{proposition}
\begin{proof}
	If $V$ is linearity compact then $E_{+} = E$ and $f_{+} = f$ for all $f \in K$. Since $[f,g] = 0$ then 
	\begin{align}\label{eqn:trivial-residue}
		\res_{V}(fdg) = 0.
	\end{align}
	On the other hand, if $V$ is discrete then $E = E_{-}$. Thus, $f = 0 \mod E_{-}$ for all $f \in K$. Thus, (\ref{eqn:trivial-residue}) holds.
\end{proof}
\begin{proposition}\label{prop:residue-and-continuity}
	Let $f$ and $g$ belong to $K$. Then, if there exists a c-lattice $L$ in $V$ so that $fL + fgL + fg^{2}L \subseteq L$ it holds $\res_{V}(fdg) = 0$. In particular, when there exists $L$ a c-lattice so that $fL \subseteq L$ and $gL \subseteq L$ then $\res_{V}(fdg) = 0$.
\end{proposition}
\begin{proof}
	Let $\pi$ be a continuous projection from $V$ to $L$. Then $\pi f \in E_{+}$ and $\pi f = f \mod E_{-}$. Thus, it follows that
	\[
		\res_{V}(fdg) = \tr([\pi f, g]) 
	\] 
	by \cref{lemm:trace-only-depends-on-K}. Let $h = [\pi f,g]$ and $W = L + gL$. Let $h_{V/W}$ and $h_{W}$ be the induced maps on $V/W$ and $W$ respectively. Then, the relation $fL + fgL + fg^{2}L \subseteq L$ implies that $h_{V/W} = 0$ and $h_{W} = 0$. By \cref{lemm:properties-trace} item (c) we conclude
	\[
		\res_{V}(fdg) = \tr_{V}(h) = \tr_{W}(h) + \tr_{V/W}(h) = 0.
	\]
\end{proof}
In the following two propositions we examine the residue of a power.
\begin{proposition}\label{prop:residue-of-a-power}
	Let $f \in K$, then $\res_{V}(f^{n}df) = 0$ for all $n \geq 0$. Moreover, if $f$ is invertible the same holds for $n \leq -2$.
\end{proposition}
\begin{proof}
	First, if $f_{+} = f \mod E_{-}$ then $f_{+}^{n} = f^{n} \mod E_{-}$. Therefore,
	\[
		\res_{V}(f^{n} df) = \tr([f_{+},f_{+}^{n}]) = 0.
	\]
	Second, if $f$ is invertible then
	\[
		fd(f^{-1}) + f^{-1}df = d(ff^{-1}) = d(1) = 0.
	\]
	which implies 
	\[
	f^{-2}df = -d(f^{-1}),
	\]
	and multiplying by $f^{-n}$ both sides, where $n\geq 0$, implies
	\[
	f^{-2-n}df = -(f^{-1})^{n}d(f^{-1}).
	\]
	By the preceding statement, $(f^{-1})^{n}d(f^{-1})$ has zero residue. 
\end{proof}
\begin{proposition}\label{prop:rediue-of-invertible-element}
	If $f$ is invertible, so that $fL \subseteq L$ for some c-lattice $L$, then
	\[
		\res_{V}(f^{-1}df) = \dim_{k}(L/fL).
	\]
\end{proposition}
\begin{proof}
	If $\pi$ is a continuous projection of $V$ into $L$ then 
	\[
	\res_{V}(f^{-1}df) = \tr([\pi f^{-1}, f]). 
	\]
	Let $g = [\pi f^{-1}, f]$. Since $fL\subseteq L$ we obtain
	\[
		g_{V/L} = 0, \quad g_{L/fL}= 1\quad\text{and,}\quad g_{fL} = 0, 
	\]
	where $g_{V/L}, g_{L/fL}$ and $g_{fL}$ denote the induced maps in $V/L$, $L/fL$ and, $fL$ respectively. Then, by \cref{lemm:properties-trace} item (c) it follows that
	\[
		\tr_{V}(g) = \tr_{L}(g) + \tr_{V/L}(g) = \tr_{fL}(g) + \tr_{L/fL}(g) + \tr_{V/L}(g).
	\]
	Observe that $\dim L/fL < \infty$ since $fL$ is open and $L$ is linearly compact.
\end{proof}





